const contratoABI = '0x60806040523480156200001157600080fd5b50604051620011c1380380620011c18339818101604052810190620000379190620000e9565b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506200011b565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620000b18262000084565b9050919050565b620000c381620000a4565b8114620000cf57600080fd5b50565b600081519050620000e381620000b8565b92915050565b6000602082840312156200010257620001016200007f565b5b60006200011284828501620000d2565b91505092915050565b611096806200012b6000396000f3fe60806040526004361061003f5760003560e01c80634d0b6efc146100445780635cef628d146100605780638837585314610077578063cf7bddef146100b6575b600080fd5b61005e60048036038101906100599190610855565b6100e1565b005b34801561006c57600080fd5b5061007561040c565b005b34801561008357600080fd5b5061009e60048036038101906100999190610922565b610507565b6040516100ad939291906109ec565b60405180910390f35b3480156100c257600080fd5b506100cb610648565b6040516100d89190610a4b565b60405180910390f35b60003411610124576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161011b90610ad8565b60405180910390fd5b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160019054906101000a900460ff16156101b3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101aa90610b44565b60405180910390fd5b6101bc8361066e565b6101fb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101f290610bb0565b60405180910390fd5b61020482610681565b610243576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161023a90610c1c565b60405180910390fd5b80610283576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161027a90610cae565b60405180910390fd5b600060405180608001604052808581526020018481526020018315158152602001600115158152509050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000190816103019190610eda565b506020820151816001015560408201518160020160006101000a81548160ff02191690831515021790555060608201518160020160016101000a81548160ff0219169083151502179055509050503373ffffffffffffffffffffffffffffffffffffffff167f1b29f6720adf8532d0bc034fcc66849672893e9921034778ed036172f1fedae5856040516103959190610fac565b60405180910390a2600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc349081150290604051600060405180830381858888f19350505050158015610405573d6000803e3d6000fd5b5050505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461049c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161049390611040565b60405180910390fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f19350505050158015610504573d6000803e3d6000fd5b50565b606060008060008060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060405180608001604052908160008201805461056790610cfd565b80601f016020809104026020016040519081016040528092919081815260200182805461059390610cfd565b80156105e05780601f106105b5576101008083540402835291602001916105e0565b820191906000526020600020905b8154815290600101906020018083116105c357829003601f168201915b50505050508152602001600182015481526020016002820160009054906101000a900460ff161515151581526020016002820160019054906101000a900460ff1615151515815250509050806000015181602001518260400151935093509350509193909250565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000808290506000815111915050919050565b60008082119050919050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6106f4826106ab565b810181811067ffffffffffffffff82111715610713576107126106bc565b5b80604052505050565b600061072661068d565b905061073282826106eb565b919050565b600067ffffffffffffffff821115610752576107516106bc565b5b61075b826106ab565b9050602081019050919050565b82818337600083830152505050565b600061078a61078584610737565b61071c565b9050828152602081018484840111156107a6576107a56106a6565b5b6107b1848285610768565b509392505050565b600082601f8301126107ce576107cd6106a1565b5b81356107de848260208601610777565b91505092915050565b6000819050919050565b6107fa816107e7565b811461080557600080fd5b50565b600081359050610817816107f1565b92915050565b60008115159050919050565b6108328161081d565b811461083d57600080fd5b50565b60008135905061084f81610829565b92915050565b60008060006060848603121561086e5761086d610697565b5b600084013567ffffffffffffffff81111561088c5761088b61069c565b5b610898868287016107b9565b93505060206108a986828701610808565b92505060406108ba86828701610840565b9150509250925092565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006108ef826108c4565b9050919050565b6108ff816108e4565b811461090a57600080fd5b50565b60008135905061091c816108f6565b92915050565b60006020828403121561093857610937610697565b5b60006109468482850161090d565b91505092915050565b600081519050919050565b600082825260208201905092915050565b60005b8381101561098957808201518184015260208101905061096e565b60008484015250505050565b60006109a08261094f565b6109aa818561095a565b93506109ba81856020860161096b565b6109c3816106ab565b840191505092915050565b6109d7816107e7565b82525050565b6109e68161081d565b82525050565b60006060820190508181036000830152610a068186610995565b9050610a1560208301856109ce565b610a2260408301846109dd565b949350505050565b6000610a35826108c4565b9050919050565b610a4581610a2a565b82525050565b6000602082019050610a606000830184610a3c565b92915050565b7f4e65636573736172696f20656e766961722065746865722070617261206d617460008201527f726963756c610000000000000000000000000000000000000000000000000000602082015250565b6000610ac260268361095a565b9150610acd82610a66565b604082019050919050565b60006020820190508181036000830152610af181610ab5565b9050919050565b7f4573747564616e7465206a61206d6174726963756c61646f0000000000000000600082015250565b6000610b2e60188361095a565b9150610b3982610af8565b602082019050919050565b60006020820190508181036000830152610b5d81610b21565b9050919050565b7f4f206e6f6d6520707265636973612073657220696e666f726d61646f00000000600082015250565b6000610b9a601c8361095a565b9150610ba582610b64565b602082019050919050565b60006020820190508181036000830152610bc981610b8d565b9050919050565b7f4120696461646520707265636973612073657220696e666f726d616461000000600082015250565b6000610c06601d8361095a565b9150610c1182610bd0565b602082019050919050565b60006020820190508181036000830152610c3581610bf9565b9050919050565b7f4f206573747564616e7465207072656369736120746572206f207072652d726560008201527f7175697369746f00000000000000000000000000000000000000000000000000602082015250565b6000610c9860278361095a565b9150610ca382610c3c565b604082019050919050565b60006020820190508181036000830152610cc781610c8b565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680610d1557607f821691505b602082108103610d2857610d27610cce565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302610d907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610d53565b610d9a8683610d53565b95508019841693508086168417925050509392505050565b6000819050919050565b6000610dd7610dd2610dcd846107e7565b610db2565b6107e7565b9050919050565b6000819050919050565b610df183610dbc565b610e05610dfd82610dde565b848454610d60565b825550505050565b600090565b610e1a610e0d565b610e25818484610de8565b505050565b5b81811015610e4957610e3e600082610e12565b600181019050610e2b565b5050565b601f821115610e8e57610e5f81610d2e565b610e6884610d43565b81016020851015610e77578190505b610e8b610e8385610d43565b830182610e2a565b50505b505050565b600082821c905092915050565b6000610eb160001984600802610e93565b1980831691505092915050565b6000610eca8383610ea0565b9150826002028217905092915050565b610ee38261094f565b67ffffffffffffffff811115610efc57610efb6106bc565b5b610f068254610cfd565b610f11828285610e4d565b600060209050601f831160018114610f445760008415610f32578287015190505b610f3c8582610ebe565b865550610fa4565b601f198416610f5286610d2e565b60005b82811015610f7a57848901518255600182019150602085019450602081019050610f55565b86831015610f975784890151610f93601f891682610ea0565b8355505b6001600288020188555050505b505050505050565b60006020820190508181036000830152610fc68184610995565b905092915050565b7f536f6d656e7465206120656d707265736120706f6465206368616d617220657360008201527f74612066756e63616f0000000000000000000000000000000000000000000000602082015250565b600061102a60298361095a565b915061103582610fce565b604082019050919050565b600060208201905081810360008301526110598161101d565b905091905056fea264697066735822122036da66e4f20df072222bf17bc52230c6bb5a6ceea3aa219acbd74018eab7f71c64736f6c63430008130033'; // Atualize com o ABI correto
const contratoEndereco = '0x591F261a15d6C27E9eE5Cd129EAd87D76072caA9';
const web3 = new Web3('http://127.0.0.1:7545');

async function enviarEther(event) {
    event.preventDefault();

    const senderAddress = document.getElementById('senderAddress').value;
    const privateKey = document.getElementById('privateKey').value;
    const recipientAddress = document.getElementById('recipientAddress').value;
    const amount = document.getElementById('amount').value;

    const nomeEstudante = document.getElementById('nomeEstudante').value;
    const idade = document.getElementById('idade').value;
    const preRequisito = document.getElementById('preRequisito').value === 'true';

    try {
        const contas = await web3.eth.getAccounts();

        
        if (!contas.includes(senderAddress)) {
            throw new Error('Endereço do remetente inválido');
        }

        
        if (!web3.utils.isAddress(recipientAddress)) {
            throw new Error('Endereço do destinatário inválido');
        }

        
        const valorWei = web3.utils.toWei(amount, 'ether');

        
        const tx = {
            to: recipientAddress,
            value: valorWei,
            gas: 2000000,
            gasPrice: await web3.eth.getGasPrice(),
            nonce: await web3.eth.getTransactionCount(senderAddress),
        };

        const signedTx = await web3.eth.accounts.signTransaction(tx, privateKey);

        // Envia a transação assinada
        const receipt = await web3.eth.sendSignedTransaction(signedTx.rawTransaction);

        console.log('Transação bem-sucedida:', receipt);
        document.getElementById('resultado').innerText = `Transação bem-sucedida! Hash: ${receipt.transactionHash}`;
    } catch (error) {
        console.error('Erro ao enviar a transação:', error);
        document.getElementById('resultado').innerText = `Erro ao enviar a transação: ${error.message}`;
    }
}

document.getElementById('formEnviarEther').addEventListener('submit', enviarEther);
